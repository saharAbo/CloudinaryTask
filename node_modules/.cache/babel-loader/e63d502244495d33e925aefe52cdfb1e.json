{"ast":null,"code":"import { writeStorage } from \"@rehooks/local-storage\";\nimport { getImages } from \"./images\";\nconst TAGS_KEY = \"Tags\";\n\nfunction getTags() {\n  return localStorage.getItem(TAGS_KEY) || \"[]\";\n}\n\nfunction add_color() {\n  const colors = JSON.parse(get_colors());\n  let color = Math.floor(Math.random() * 16777215).toString(16);\n\n  while (colors.indexOf(color) > -1) color = Math.floor(Math.random() * 16777215).toString(16);\n\n  colors.push(color);\n  writeStorage(\"Tags_colors\", colors);\n}\n\nfunction get_colors() {\n  return localStorage.getItem(\"Tags_colors\") || \"[]\";\n}\n\nfunction remove_color(idx) {\n  const colors = JSON.parse(get_colors());\n  colors.splice(idx, 1);\n  writeStorage(\"Tags_colors\", colors);\n}\n\nfunction addTag(name) {\n  let tags = JSON.parse(getTags());\n\n  if (tags.indexOf(name) == -1) {\n    tags.push(name);\n    add_color();\n  }\n\n  setTags(tags);\n}\n\nfunction removeTag(name) {\n  const tags = JSON.parse(getTags());\n  const images = JSON.parse(localStorage.getItem(\"Images\") || \"[]\");\n  const idx = tags.indexOf(name);\n\n  if (idx >= 0) {\n    tags.splice(idx, 1);\n    setTags(tags);\n    const imgs = [];\n\n    for (let i = 0; i < images.length; i++) {\n      const img = images[i];\n\n      if (img.selectedTags && img.selectedTags.indexOf(name) > -1) {\n        img.selectedTags = img.selectedTags.filter(t => t != name);\n      }\n\n      imgs.push(img);\n    }\n\n    writeStorage(\"Images\", imgs);\n  }\n}\n\nconst updateTag = (oldTag, newTag) => {\n  console.log(oldTag, newTag);\n  const tags = JSON.parse(getTags());\n  const images = JSON.parse(localStorage.getItem(\"Images\") || \"[]\");\n  const idx = tags.indexOf(oldTag);\n\n  if (idx >= 0) {\n    tags[idx] = newTag;\n    const imgs = [];\n\n    for (let i = 0; i < images.length; i++) {\n      const img = images[i];\n\n      if (img.selectedTags) {\n        const imgTagIndex = img.selectedTags.indexOf(oldTag);\n        if (imgTagIndex > -1) img.selectedTags[imgTagIndex] = newTag;\n        imgs.push(img);\n      } else imgs.push(img);\n    }\n\n    writeStorage(\"Images\", imgs);\n    setTags(tags);\n  }\n};\n\nfunction setTags(tags) {\n  writeStorage(TAGS_KEY, tags);\n}\n\nexport { setTags, addTag, removeTag, getTags, updateTag, get_colors };","map":{"version":3,"names":["writeStorage","getImages","TAGS_KEY","getTags","localStorage","getItem","add_color","colors","JSON","parse","get_colors","color","Math","floor","random","toString","indexOf","push","remove_color","idx","splice","addTag","name","tags","setTags","removeTag","images","imgs","i","length","img","selectedTags","filter","t","updateTag","oldTag","newTag","console","log","imgTagIndex"],"sources":["C:/Users/AA/Desktop/NewOne/src/db/tags.js"],"sourcesContent":["import { writeStorage } from \"@rehooks/local-storage\";\nimport { getImages } from \"./images\";\n\nconst TAGS_KEY = \"Tags\";\n\nfunction getTags() {\n  return localStorage.getItem(TAGS_KEY) || \"[]\";\n}\n\nfunction add_color() {\n  const colors = JSON.parse(get_colors());\n  let color = Math.floor(Math.random() * 16777215).toString(16);\n  while (colors.indexOf(color) > -1)\n    color = Math.floor(Math.random() * 16777215).toString(16);\n  colors.push(color);\n  writeStorage(\"Tags_colors\", colors);\n}\n\nfunction get_colors() {\n  return localStorage.getItem(\"Tags_colors\") || \"[]\";\n}\n\nfunction remove_color(idx) {\n  const colors = JSON.parse(get_colors());\n  colors.splice(idx, 1);\n  writeStorage(\"Tags_colors\", colors);\n}\nfunction addTag(name) {\n  let tags = JSON.parse(getTags());\n\n  if (tags.indexOf(name) == -1) {\n    tags.push(name);\n    add_color();\n  }\n  setTags(tags);\n}\n\nfunction removeTag(name) {\n  const tags = JSON.parse(getTags());\n  const images = JSON.parse(localStorage.getItem(\"Images\") || \"[]\");\n  const idx = tags.indexOf(name);\n  if (idx >= 0) {\n    tags.splice(idx, 1);\n    setTags(tags);\n    const imgs = [];\n    for (let i = 0; i < images.length; i++) {\n      const img = images[i];\n      if (img.selectedTags && img.selectedTags.indexOf(name) > -1) {\n        img.selectedTags = img.selectedTags.filter((t) => t != name);\n      }\n      imgs.push(img);\n    }\n    writeStorage(\"Images\", imgs);\n  }\n}\n\nconst updateTag = (oldTag, newTag) => {\n  console.log(oldTag, newTag);\n  const tags = JSON.parse(getTags());\n  const images = JSON.parse(localStorage.getItem(\"Images\") || \"[]\");\n  const idx = tags.indexOf(oldTag);\n  if (idx >= 0) {\n    tags[idx] = newTag;\n    const imgs = [];\n    for (let i = 0; i < images.length; i++) {\n      const img = images[i];\n      if (img.selectedTags) {\n        const imgTagIndex = img.selectedTags.indexOf(oldTag);\n        if (imgTagIndex > -1) img.selectedTags[imgTagIndex] = newTag;\n        imgs.push(img);\n      } else imgs.push(img);\n    }\n    writeStorage(\"Images\", imgs);\n    setTags(tags);\n  }\n};\n\nfunction setTags(tags) {\n  writeStorage(TAGS_KEY, tags);\n}\n\nexport { setTags, addTag, removeTag, getTags, updateTag, get_colors };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}